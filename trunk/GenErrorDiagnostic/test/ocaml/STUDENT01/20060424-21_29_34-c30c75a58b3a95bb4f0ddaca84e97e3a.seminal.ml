(* #############################################################
############################################################
*)

(* ################################################## *)
open Thread
open Event

exception Unimplemented

let sendNow ch a = sync (send ch a) (*block###
##################################

#########################################################
###############
#################################
#################################
###############################
#####################################state###
####################
################
#############################
###########################################################
###########################
##################
######################################################################################################
##################################
########################
##############################################################################
##################################
####################
###########
##
#####spawn off thread###
##########################
#####return channels###
############################

################
#########################
#########################################

################
##################################
#####################################

############################################
#####################

##
let myTrans = 
  print_string("depositing 20 dollars...\n");
  let _ = put myAcct 20.0 in 
  let one = get myAcct 5.0 in 
  print_string ("result: " ^ string_of_float(get myAcct one) ^ "\n");
  let _ = put myAcct 20.0 in 
  let result = get myAcct 5.0 in 
  result

let _ = print_string ("\nfinal balance: " ^ string_of_float(myTrans) ^ "\n")

let _ = 
  let _ = put myAcct 25.0 in 
  let _,_,myGetCh = myAcct in
  let _ = sendNow myGetCh 5.0 in 
  yield();
  let _ = sendNow myGetCh 4.0 in 
  ()
##

#########
###########################
############################
####################
### sendNow getCh 2.0;*)
  print_string ("1: " ^ string_of_float(recvNow getCh) ^ "\n");
  ()
(* 11,19-34 *)
